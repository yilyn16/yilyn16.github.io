# 一条数据是如何写入的

InnoDB作为使用最广的一款引擎，在众多引擎中对可靠性和高性能之间做了平衡，在事物控制、读写效率、并发、索引搜索等方面都有不错的表现。

InnoDB作为存储引擎，通过执行器对内存和磁盘中的数据进行写入和读取，本章主要看一下数据写入的过程。

1. 通过MySQL Server层的SQL接口和SQL解析器，将SQL解析为MySQL能够识别的语句，生成一个解析树；
2. 然后SQL优化器会对这个SQL语句进行优化，生成执行计划，通过执行器传给InnoDB引擎；
3. 开始执行后，首先为了让写入数据支持回滚操作，需要把旧的值记录到undo log文件中；
4. 因为MySQL最终的数据都是存在磁盘中，但是每次写入如果都需要写入磁盘的话，效率就太低了，所以InnoDB将所有的写入请求都写到内存中的Buffer Pool中；
5. InnoDB 会有单独的IO线程将 Buffer Pool 中的数据读取出来，然后写入磁盘，这个写入磁盘的过程是通过操作系统的open+write函数写入磁盘的 .idb 文件；
6. 至此，数据写入就算完成了。

![数据写入流程](/images/databases/数据写入流程.png)

### MySQL宕机，如何保证数据完整？






