<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Docker | yilyn</title>
    <meta name="generator" content="VuePress 1.9.9">
    <link rel="icon" href="/images/logo.png">
    <meta name="description" content="">
    
    <link rel="preload" href="/assets/css/0.styles.7ba09758.css" as="style"><link rel="preload" href="/assets/js/app.03d6e582.js" as="script"><link rel="preload" href="/assets/js/2.108ee2cf.js" as="script"><link rel="preload" href="/assets/js/18.32de4958.js" as="script"><link rel="prefetch" href="/assets/js/10.a57b8461.js"><link rel="prefetch" href="/assets/js/11.ee67e699.js"><link rel="prefetch" href="/assets/js/12.a2ee7370.js"><link rel="prefetch" href="/assets/js/13.a2d1c5fe.js"><link rel="prefetch" href="/assets/js/14.e598d318.js"><link rel="prefetch" href="/assets/js/15.60ac77e5.js"><link rel="prefetch" href="/assets/js/16.761000c3.js"><link rel="prefetch" href="/assets/js/17.6215293a.js"><link rel="prefetch" href="/assets/js/19.873b9daa.js"><link rel="prefetch" href="/assets/js/20.1e66027a.js"><link rel="prefetch" href="/assets/js/21.3359ef2c.js"><link rel="prefetch" href="/assets/js/22.8b3485e6.js"><link rel="prefetch" href="/assets/js/23.389bcd64.js"><link rel="prefetch" href="/assets/js/24.365d9815.js"><link rel="prefetch" href="/assets/js/25.9945e0c8.js"><link rel="prefetch" href="/assets/js/26.80724398.js"><link rel="prefetch" href="/assets/js/27.2e9536f5.js"><link rel="prefetch" href="/assets/js/28.5ba67c56.js"><link rel="prefetch" href="/assets/js/29.18d9b60b.js"><link rel="prefetch" href="/assets/js/3.404fa27f.js"><link rel="prefetch" href="/assets/js/30.590ac2e8.js"><link rel="prefetch" href="/assets/js/31.8397f555.js"><link rel="prefetch" href="/assets/js/32.a4c7dce0.js"><link rel="prefetch" href="/assets/js/33.cd124a03.js"><link rel="prefetch" href="/assets/js/4.061dd861.js"><link rel="prefetch" href="/assets/js/5.48d5b9da.js"><link rel="prefetch" href="/assets/js/6.57e1d6ad.js"><link rel="prefetch" href="/assets/js/7.bf7085c0.js"><link rel="prefetch" href="/assets/js/8.80c08002.js"><link rel="prefetch" href="/assets/js/9.621e63fd.js">
    <link rel="stylesheet" href="/assets/css/0.styles.7ba09758.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/images/logo.png" alt="yilyn" class="logo"> <span class="site-name can-hide">yilyn</span></a> <div class="links"><!----> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">
  首页
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="JAVA基础" class="dropdown-title"><span class="title">JAVA基础</span> <span class="arrow down"></span></button> <button type="button" aria-label="JAVA基础" class="mobile-dropdown-title"><span class="title">JAVA基础</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/java_basics/collections/" class="nav-link">
  集合类
</a></li><li class="dropdown-item"><!----> <a href="/java_basics/multi_threads/" class="nav-link">
  多线程
</a></li><li class="dropdown-item"><!----> <a href="/java_basics/JUC/" class="nav-link">
  JUC
</a></li><li class="dropdown-item"><!----> <a href="/java_basics/jvm/" class="nav-link">
  JVM
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="网络" class="dropdown-title"><span class="title">网络</span> <span class="arrow down"></span></button> <button type="button" aria-label="网络" class="mobile-dropdown-title"><span class="title">网络</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/network/netty/" class="nav-link">
  netty
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="环境搭建" class="dropdown-title"><span class="title">环境搭建</span> <span class="arrow down"></span></button> <button type="button" aria-label="环境搭建" class="mobile-dropdown-title"><span class="title">环境搭建</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/env_build/blog_vuepress/" class="nav-link">
  博客by-vuepress
</a></li><li class="dropdown-item"><!----> <a href="/env_build/docker/" aria-current="page" class="nav-link router-link-exact-active router-link-active">
  docker
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="大数据" class="dropdown-title"><span class="title">大数据</span> <span class="arrow down"></span></button> <button type="button" aria-label="大数据" class="mobile-dropdown-title"><span class="title">大数据</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/big_data/flink-cdc/" class="nav-link">
  Flink CDC
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="数据库" class="dropdown-title"><span class="title">数据库</span> <span class="arrow down"></span></button> <button type="button" aria-label="数据库" class="mobile-dropdown-title"><span class="title">数据库</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/databases/mysql/" class="nav-link">
  MySQL
</a></li><li class="dropdown-item"><!----> <a href="/databases/redis/" class="nav-link">
  Redis
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="记录" class="dropdown-title"><span class="title">记录</span> <span class="arrow down"></span></button> <button type="button" aria-label="记录" class="mobile-dropdown-title"><span class="title">记录</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/take_notes/interview/" class="nav-link">
  面试
</a></li></ul></div></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">
  首页
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="JAVA基础" class="dropdown-title"><span class="title">JAVA基础</span> <span class="arrow down"></span></button> <button type="button" aria-label="JAVA基础" class="mobile-dropdown-title"><span class="title">JAVA基础</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/java_basics/collections/" class="nav-link">
  集合类
</a></li><li class="dropdown-item"><!----> <a href="/java_basics/multi_threads/" class="nav-link">
  多线程
</a></li><li class="dropdown-item"><!----> <a href="/java_basics/JUC/" class="nav-link">
  JUC
</a></li><li class="dropdown-item"><!----> <a href="/java_basics/jvm/" class="nav-link">
  JVM
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="网络" class="dropdown-title"><span class="title">网络</span> <span class="arrow down"></span></button> <button type="button" aria-label="网络" class="mobile-dropdown-title"><span class="title">网络</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/network/netty/" class="nav-link">
  netty
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="环境搭建" class="dropdown-title"><span class="title">环境搭建</span> <span class="arrow down"></span></button> <button type="button" aria-label="环境搭建" class="mobile-dropdown-title"><span class="title">环境搭建</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/env_build/blog_vuepress/" class="nav-link">
  博客by-vuepress
</a></li><li class="dropdown-item"><!----> <a href="/env_build/docker/" aria-current="page" class="nav-link router-link-exact-active router-link-active">
  docker
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="大数据" class="dropdown-title"><span class="title">大数据</span> <span class="arrow down"></span></button> <button type="button" aria-label="大数据" class="mobile-dropdown-title"><span class="title">大数据</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/big_data/flink-cdc/" class="nav-link">
  Flink CDC
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="数据库" class="dropdown-title"><span class="title">数据库</span> <span class="arrow down"></span></button> <button type="button" aria-label="数据库" class="mobile-dropdown-title"><span class="title">数据库</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/databases/mysql/" class="nav-link">
  MySQL
</a></li><li class="dropdown-item"><!----> <a href="/databases/redis/" class="nav-link">
  Redis
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="记录" class="dropdown-title"><span class="title">记录</span> <span class="arrow down"></span></button> <button type="button" aria-label="记录" class="mobile-dropdown-title"><span class="title">记录</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/take_notes/interview/" class="nav-link">
  面试
</a></li></ul></div></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>各种环境搭建</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/env_build/blog_vuepress/" class="sidebar-link">vuepress搭建博客</a></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><a href="/env_build/docker/" aria-current="page" class="sidebar-heading clickable router-link-exact-active router-link-active open active"><span>docker</span> <span class="arrow down"></span></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/env_build/docker/Docker搭建ES集群.html" class="sidebar-link">docker搭建ES集群</a></li></ul></section></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="docker"><a href="#docker" class="header-anchor">#</a> Docker</h1> <p></p><div class="table-of-contents"><ul><li><a href="#docker">Docker</a><ul><li><a href="#docker-是什么">Docker 是什么？</a><ul><li><a href="#docker-包括三个组成部分">Docker 包括三个组成部分</a></li></ul></li><li><a href="#docker的安装">Docker的安装</a></li><li><a href="#docker常用命令">Docker常用命令</a><ul><li><a href="#命令中一些参数的含义">命令中一些参数的含义</a></li></ul></li><li><a href="#docker的容器和镜像使用">Docker的容器和镜像使用</a><ul><li><a href="#docker-build-构建自定义镜像">docker build 构建自定义镜像</a></li></ul></li><li><a href="#常用软件安装">常用软件安装</a><ul><li><a href="#docker-安装-mysql-8-0">Docker 安装 Mysql（8.0）</a></li><li><a href="#docker-安装-redis">Docker 安装 Redis</a></li><li><a href="#docker-安装-es-7-6-2-和-kibana">Docker 安装 ES（7.6.2 ）和 Kibana</a></li></ul></li><li><a href="#springboot项目部署到docker">Springboot项目部署到Docker</a></li></ul></li></ul></div><p></p> <h2 id="docker-是什么"><a href="#docker-是什么" class="header-anchor">#</a> Docker 是什么？</h2> <p>Docker 是一个开源的应用容器引擎，基于 <code>GO 语言</code>并遵从 Apache2.0 协议开源。</p> <p>Docker 可以让开发者打包他们的应用以及依赖包到一个轻量级、可移植的容器中，然后发布到任何流行的 Linux 机器上，也可以实现虚拟化。</p> <p>容器是完全使用沙箱机制，相互之间不会有任何接口（类似 iPhone 的 app）,更重要的是容器性能开销极低。</p> <h4 id="相比传统的虚拟机-docker有如下优点"><a href="#相比传统的虚拟机-docker有如下优点" class="header-anchor">#</a> 相比传统的虚拟机，Docker有如下优点：</h4> <ol><li>部署在容器的Docker程序，使用的都是宿主机的硬件资源，对硬件的资源使用率高</li> <li>Docker启动快，轻量，是传统虚拟机无法相比的</li> <li>兼容性高，可以在物理机、公有云、私有云、个人电脑等设备上使用</li> <li>可以快速部署和扩容</li></ol> <h3 id="docker-包括三个组成部分"><a href="#docker-包括三个组成部分" class="header-anchor">#</a> Docker 包括三个组成部分</h3> <ol><li><strong>镜像（Image）</strong>：可与你理解为一个容器的定义。</li> <li><strong>容器（Container）</strong>：镜像和容器的关系就类似面向对象程序中的<code>类</code>和<code>对象实例</code>一样，镜像是静态的定义，容器是镜像运行的实体。</li> <li><strong>仓库（Repository）</strong>：用来存放镜像。</li></ol> <h2 id="docker的安装"><a href="#docker的安装" class="header-anchor">#</a> Docker的安装</h2> <ol><li>Docker中文官网： https://docker.p2hp.com/， 首页点击下载然后安装即可</li> <li>Homebrew安装（Mac OS）</li></ol> <h2 id="docker常用命令"><a href="#docker常用命令" class="header-anchor">#</a> Docker常用命令</h2> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token comment"># docker下所有容器</span>
<span class="token function">docker</span> <span class="token function">ps</span> <span class="token parameter variable">-a</span>

<span class="token comment"># docker下正在运行的容器</span>
<span class="token function">docker</span> <span class="token function">ps</span>

<span class="token comment"># docker下所有的镜像</span>
<span class="token function">docker</span> images

<span class="token comment"># 删除镜像</span>
<span class="token function">docker</span> rmi 镜像id/镜像名

<span class="token comment"># 停止容器</span>
<span class="token function">docker</span> stop 容器id/容器名

<span class="token comment"># 删除容器</span>
<span class="token function">docker</span> <span class="token function">rm</span> <span class="token parameter variable">-f</span> 容器id/容器名

<span class="token comment"># 访问某个容器内部的终端</span>
<span class="token function">docker</span> <span class="token builtin class-name">exec</span> <span class="token parameter variable">-ti</span> 容器ID /bin/bash

<span class="token comment">#查看容器底层信息</span>
<span class="token function">docker</span> inspect 容器id/容器名

<span class="token comment"># 构建一个新的docker镜像，注意最后的.必须得加</span>
<span class="token function">docker</span> build <span class="token parameter variable">-t</span> 镜像名 <span class="token builtin class-name">.</span>

<span class="token comment"># 运行镜像，第一个8080指的是容器内部的端口，第二个8080指的是宿主机的端口</span>
<span class="token function">docker</span> run <span class="token parameter variable">-d</span> <span class="token parameter variable">-p</span> <span class="token number">8080</span>:8080 镜像id/镜像名

<span class="token comment"># 或者在运行时使用--name可以定义容器名称</span>
<span class="token function">docker</span> run <span class="token parameter variable">-d</span> <span class="token parameter variable">-p</span> <span class="token number">8080</span>:8080 <span class="token parameter variable">--name</span> 容器名 镜像名

<span class="token comment"># 退出容器终端</span>
<span class="token builtin class-name">exit</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br></div></div><h3 id="命令中一些参数的含义"><a href="#命令中一些参数的含义" class="header-anchor">#</a> 命令中一些参数的含义</h3> <div class="language- line-numbers-mode"><pre class="language-text"><code>-t: 在新容器内指定一个伪终端或终端。

-i: 允许你对容器内的标准输入 (STDIN) 进行交互。

-d: 容器启动后后台运行

-P:将容器内部使用的网络端口随机映射到我们使用的主机上。

-p：设置宿主机端口与容器端口映射
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p>还可以使用 <code>docker command --help</code> 查看命令相关的帮助</p> <h2 id="docker的容器和镜像使用"><a href="#docker的容器和镜像使用" class="header-anchor">#</a> Docker的容器和镜像使用</h2> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token comment"># 查找镜像</span>
<span class="token function">docker</span> search mysql

<span class="token comment"># 拉取镜像，如果不带冒号后面的版本，则会拉取最新的版本</span>
<span class="token function">docker</span> pull ubuntu:13.10

<span class="token comment"># 运行镜像，如果没有这个镜像，则会拉取一个新的镜像并启动这个镜像</span>
<span class="token function">docker</span> run <span class="token parameter variable">-t</span> <span class="token parameter variable">-i</span> ubuntu:13.10 /bin/bash
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><h3 id="docker-build-构建自定义镜像"><a href="#docker-build-构建自定义镜像" class="header-anchor">#</a> docker build 构建自定义镜像</h3> <p>使用docker build命令构建自定义镜像，需要使用Dockerfile文件，这个文件内置了指令，告诉Docker如何构建镜像</p> <h2 id="常用软件安装"><a href="#常用软件安装" class="header-anchor">#</a> 常用软件安装</h2> <h3 id="docker-安装-mysql-8-0"><a href="#docker-安装-mysql-8-0" class="header-anchor">#</a> Docker 安装 Mysql（8.0）</h3> <ol><li>拉取镜像</li></ol> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token function">docker</span> pull mysql:8.0
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><ol start="2"><li>启动镜像</li></ol> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token function">docker</span> run <span class="token parameter variable">-itd</span> <span class="token parameter variable">--name</span> mysql8.0 <span class="token parameter variable">-p</span> <span class="token number">3306</span>:3306 <span class="token parameter variable">-e</span> <span class="token assign-left variable">MYSQL_ROOT_PASSWORD</span><span class="token operator">=</span>root mysql
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>参数说明：</p> <p><strong>-p 3306:3306</strong>   将容器的3306端口映射到宿主机的3306端口，可以在外部使用容器IP:3306访问</p> <p><strong>MYSQL_ROOT_PASSWORD=root</strong>  设置mysql的root用户密码为root</p> <ol start="3"><li>查看容器是否启动</li></ol> <div class="language-sh line-numbers-mode"><pre class="language-sh"><code><span class="token function">docker</span> <span class="token function">ps</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><ol start="4"><li>时间调整</li></ol> <p>docker中的mysql服务器时间没有使用北京时间，使用前需要先调一下</p> <div class="language- line-numbers-mode"><pre class="language-text"><code># 1. 先进入mysql容器
docker exec -ti 容器ID /bin/bash

# 2. 修改时区
ln -sf /usr/share/zoneinfo/Asia/Shanghai /etc/localtime &amp;&amp; echo &quot;Asia/Shanghai&quot; &gt; /etc/timezone 

# 3. 退出容器
exit

# 4. 重启容器即可生效
docker restart 容器ID
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><h3 id="docker-安装-redis"><a href="#docker-安装-redis" class="header-anchor">#</a> Docker 安装 Redis</h3> <ol><li>拉取镜像</li></ol> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token function">docker</span> pull redis
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><ol start="2"><li>运行redis镜像</li></ol> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token function">docker</span> run <span class="token parameter variable">-itd</span> <span class="token parameter variable">--name</span> redis <span class="token parameter variable">-p</span> <span class="token number">6379</span>:6379 redis
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h3 id="docker-安装-es-7-6-2-和-kibana"><a href="#docker-安装-es-7-6-2-和-kibana" class="header-anchor">#</a> Docker 安装 ES（7.6.2 ）和 Kibana</h3> <ol><li>拉取镜像</li></ol> <div class="language-sh line-numbers-mode"><pre class="language-sh"><code><span class="token function">docker</span> pull elasticsearch:7.6.2
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><ol start="2"><li>运行镜像</li></ol> <div class="language-sh line-numbers-mode"><pre class="language-sh"><code><span class="token function">docker</span> run <span class="token parameter variable">-p</span> <span class="token number">9200</span>:9200 <span class="token parameter variable">-p</span> <span class="token number">9300</span>:9300 <span class="token parameter variable">-e</span> <span class="token string">&quot;discovery.type=single-node&quot;</span> <span class="token parameter variable">-e</span> <span class="token assign-left variable">ES_JAVA_OPTS</span><span class="token operator">=</span><span class="token string">&quot;-Xms512m -Xmx512m&quot;</span> <span class="token parameter variable">--name</span> elasticsearch7.6.2 <span class="token parameter variable">-d</span> elasticsearch:7.6.2
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><ol start="3"><li>访问localhost:9200 ,如果返回es相关信息，说明启动成功</li> <li>安装Kibana</li></ol> <div class="language-sh line-numbers-mode"><pre class="language-sh"><code><span class="token function">docker</span> pull kibana:7.6.2
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><ol start="5"><li>在本地自定义的目录下新建Dockerfile目录，用于存放Dockerfile文件，并创建kibana.yml文件</li></ol> <div class="language-yml line-numbers-mode"><pre class="language-yml"><code><span class="token key atrule">server.name</span><span class="token punctuation">:</span> kibana
<span class="token key atrule">server.host</span><span class="token punctuation">:</span> <span class="token string">&quot;0&quot;</span>
<span class="token key atrule">elasticsearch.hosts</span><span class="token punctuation">:</span> <span class="token punctuation">[</span> <span class="token string">&quot;http://100.125.11.37:9200&quot;</span><span class="token punctuation">]</span>  
<span class="token key atrule">xpack.monitoring.ui.container.elasticsearch.enabled</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><ol start="6"><li>启动kibana</li></ol> <div class="language-sh line-numbers-mode"><pre class="language-sh"><code><span class="token function">docker</span> run <span class="token parameter variable">--name</span> kibana <span class="token parameter variable">-v</span> /Users/yanglin/Documents/Dockerfile/kibana7.6.2/kibana.yml:/usr/share/kibana/config/kibana.yml <span class="token parameter variable">-p</span> <span class="token number">5601</span>:5601 <span class="token parameter variable">-d</span> kibana:7.6.2

<span class="token comment"># 说明:</span>
<span class="token comment"># /Users/yanglin/Documents/Dockerfile/kibana7.6.2/kibana.yml 是宿主机的yml所在文件位置</span>
<span class="token comment"># /usr/share/kibana/config/kibana.yml 是kibana容器存放的位置</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><ol start="7"><li>通过访问 localhost:5601 即可访问kibana</li></ol> <h2 id="springboot项目部署到docker"><a href="#springboot项目部署到docker" class="header-anchor">#</a> Springboot项目部署到Docker</h2> <h4 id="_1-项目开发"><a href="#_1-项目开发" class="header-anchor">#</a> 1. 项目开发</h4> <p>简单开发一个springboot应用，创建controller，方便测试</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token annotation punctuation">@RestController</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">HelloController</span> <span class="token punctuation">{</span>

    <span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span><span class="token string">&quot;/&quot;</span><span class="token punctuation">)</span>
    <span class="token annotation punctuation">@ResponseBody</span>
    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">hello</span><span class="token punctuation">(</span><span class="token class-name">String</span> echo<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token string">&quot;hello &quot;</span> <span class="token operator">+</span> echo<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><h4 id="_2-编写dockerfile文件"><a href="#_2-编写dockerfile文件" class="header-anchor">#</a> 2. 编写Dockerfile文件</h4> <div class="language- line-numbers-mode"><pre class="language-text"><code># Docker image for springboot file run
# VERSION 0.0.1
# Author: 
# 基础镜像使用java
FROM openjdk:8
MAINTAINER yilyn
# VOLUME 指定了临时文件目录为/tmp。
# 其效果是在主机 Dockerfile所在目录下创建了一个临时文件(如果不指定，则默认在docker的文件夹下)，并链接到容器的/tmp
VOLUME /Users/yanglin/Documents/Dockerfile/yilyn-docker-demo /tmp 
# 将jar包添加到容器中并更名为xx.jar
ADD yilyn-docker-demo.jar yilyn-docker-demo.jar
# 运行jar包
RUN bash -c 'touch /yilyn-docker-demo.jar'
ENTRYPOINT [&quot;java&quot;,&quot;-Djava.security.egd=file:/dev/./urandom&quot;,&quot;-jar&quot;,&quot;/yilyn-docker-demo.jar&quot;]
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><h4 id="_3-应用打包"><a href="#_3-应用打包" class="header-anchor">#</a> 3. 应用打包</h4> <p>将Springboot应用打成jar包，并将这个jar包放到Dockerfile所在的文件夹下，注意jar包的名字要和Dockerfile指定的文件名相同</p> <h4 id="_4-使用docker-build构建镜像"><a href="#_4-使用docker-build构建镜像" class="header-anchor">#</a> 4. 使用docker build构建镜像</h4> <p>先进入Dockerfile所在的目录下，然后执行构建命令</p> <div class="language-sh line-numbers-mode"><pre class="language-sh"><code><span class="token function">docker</span> build <span class="token parameter variable">-t</span> yilyn-docker-demo:1.0 <span class="token builtin class-name">.</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>构建完成以后查看是否构建成功</p> <div class="language-sh line-numbers-mode"><pre class="language-sh"><code><span class="token function">docker</span> images
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><img src="/images/docker/docker-images.png" alt="docker-images"></p> <h4 id="_5-启动镜像"><a href="#_5-启动镜像" class="header-anchor">#</a> 5. 启动镜像</h4> <div class="language-sh line-numbers-mode"><pre class="language-sh"><code><span class="token comment"># 通过宿主机IP:8080访问docker容器的8080端口</span>
<span class="token function">docker</span> run <span class="token parameter variable">-d</span> <span class="token parameter variable">-p</span> <span class="token number">8080</span>:8080 <span class="token parameter variable">--name</span> yilyn-docker-demo yilyn-docker-demo:1.0
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h4 id="_6-验证是否发布成功"><a href="#_6-验证是否发布成功" class="header-anchor">#</a> 6. 验证是否发布成功</h4> <p>访问localhost:8080 ，如图，说明发布成功</p> <p><img src="/images/docker/%E8%AE%BF%E9%97%AE8080.png" alt="验证截图"></p></div> <footer class="page-edit"><!----> <!----></footer> <!----> </main></div><div class="global-ui"><!----><!----></div></div>
    <script src="/assets/js/app.03d6e582.js" defer></script><script src="/assets/js/2.108ee2cf.js" defer></script><script src="/assets/js/18.32de4958.js" defer></script>
  </body>
</html>
