"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.resolveThemeLayouts = void 0;
const shared_1 = require("@vuepress/shared");
const utils_1 = require("@vuepress/utils");
const resolveThemeLayouts = async ({ themePath, themePlugin, }) => {
    // use the layouts component map directly
    if (shared_1.isPlainObject(themePlugin.layouts)) {
        return Object.entries(themePlugin.layouts).map(([name, file]) => ({
            name,
            path: file,
        }));
    }
    // resolve the layouts directory
    const dirLayout = shared_1.isString(themePlugin.layouts) && utils_1.path.isAbsolute(themePlugin.layouts)
        ? themePlugin.layouts
        : utils_1.path.resolve(themePath, 'layouts');
    if (!(await utils_1.fs.pathExists(dirLayout))) {
        utils_1.logger.warn(`layout path ${utils_1.chalk.magenta(dirLayout)} does not exist`);
        return [];
    }
    // load all files in layouts directory
    const files = await utils_1.fs.readdir(dirLayout);
    // take matched files as theme layouts
    const layouts = files
        .filter((file) => /\.(vue|ts|js)$/.test(file))
        .map((file) => ({
        name: utils_1.path.trimExt(file),
        path: utils_1.path.resolve(dirLayout, file),
    }));
    return layouts;
};
exports.resolveThemeLayouts = resolveThemeLayouts;
