"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.createThemeApi = void 0;
const resolveThemeInfo_1 = require("./resolveThemeInfo");
/**
 * Create vuepress theme-api
 *
 * Resolve current theme, parent theme, theme layouts
 */
const createThemeApi = async (app) => {
    // resolve theme info
    const theme = await resolveThemeInfo_1.resolveThemeInfo(app, app.options.theme);
    // resolve parent theme info
    const parentTheme = theme.plugin.extends
        ? await resolveThemeInfo_1.resolveThemeInfo(app, theme.plugin.extends)
        : null;
    // resolve theme layouts
    const layouts = theme.layouts;
    // layouts in child theme will override
    // those with the same name in parent theme
    if (parentTheme !== null) {
        layouts.unshift(...parentTheme.layouts.filter(({ name: parentLayoutName }) => !theme.layouts.some(({ name: childLayoutName }) => childLayoutName === parentLayoutName)));
    }
    return {
        theme,
        parentTheme,
        layouts,
    };
};
exports.createThemeApi = createThemeApi;
